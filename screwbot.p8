pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
--screwbot
--by kirais

function _init()
	robot={
	 body=15, -- sprite id
	 head=0,
	 heady=72,
	 x=0,
	 y=80,
	 speed=1
	}
	clamp={
	 spr=16,
		x=60,
		y=50,
		speed=1
	}
	release=false
end

function _update()
 -- check collision
 if not col then
  col = check_col(robot,clamp)
 end
 
 if release then 
 	col=false
 	release_action() 
 end
 -- if clamp and robot collide
 if col then
  rotate_clamp(1)
  rotate_head()
 	if btn(ðŸ…¾ï¸) then
 	 rotate_clamp(1)
   rotate_head()
  else
 		release=true
 		clamp.y-=clamp.speed
 	end
 -- if not, robot moves
 else
  robot.x+=robot.speed
  if btn(ðŸ…¾ï¸) then
  clamp.y+=clamp.speed
 	end
 end
end

function _draw()
	cls()
	spr(robot.head,robot.x,robot.heady)
 spr(robot.body,robot.x,robot.y)
 spr(clamp.spr,clamp.x,clamp.y)
end

function check_col(robot, clamp)
 if robot.x>clamp.x-8 and 
 				robot.x<clamp.x+8 then
 	if robot.y>clamp.y and
 	    robot.y<clamp.y+16 then
 		col = true
 		robot.x = clamp.x
 		clamp.y = robot.y-15
 	end
 end
 return col
end

function release_action()
 clamp.y-=clamp.speed
 rotate_clamp(-1)
end

function rotate_clamp(direct)
 if direct>0 then
  if clamp.spr<20 then
  	clamp.spr+=1
  	if clamp.y<robot.heady-7 then
  	 clamp.y+=0.1 end
 	else
  	clamp.spr=16
  end
 else
  if clamp.spr>16.1 then
  	clamp.spr-=0.1
 	else
  	clamp.spr=16
  end
 end
end

function rotate_head()
 if robot.heady<robot.y-4 then
  robot.heady+=0.1
 	if robot.head<4 then
  	robot.head+=1
 	else
  	robot.head=0
  end
 else
  -- fix head direction
  robot.head=4
 end
end
__gfx__
88888888888888888888888888888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000777700
80000078800007088000700880070078807007080000000000000000000000000000000000000000000000000000000000000000000000000000000000700700
80000008800000088000000880000008800000080000000000000000000000000000000000000000000000000000000000000000000000000000000000700700
88888888888888888888888888888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000007700770
00088000000880000008800000088000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000070777707
00088000000880000008800000088000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000070777707
00088000000880000008800000088000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000
00088000000880000008800000088000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000000777700
00065000000650000006500000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00065000000650000006500000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00066000000660000006600000066000000660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00665500006655000066650000066000000660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06600550066005500060050000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60000005060000500060050000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60000005060000500060050000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06000050006005000006500000065000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
